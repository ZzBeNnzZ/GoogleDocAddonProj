<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      .bar-container {
        width: 100%;
        background-color: #ddd;
        border-radius: 10px;
        margin-bottom: 15px;
      }

      .bar {
        height: 20px;
        border-radius: 10px;
        text-align: right;
        padding-right: 5px;
        color: white;
        line-height: 20px;
        transition: width 0.5s;
      }

      .expected {
        /*width: 50%; /* Placeholder for expected progress */
        background-color: #8888ff;
      }

      .actual {
        /*width: 30%; /* Placeholder for actual progress */
        background-color: #66cc66;
      }
    </style>
  </head>
  <body>
    
    <h2>Writing Progress</h2>

    <div><strong>Expected Progress</strong></div>
    <div class="bar-container">
      <div class="bar expected" id="expectedBar">50%</div>
    </div>

    <div><strong>Actual Progress</strong></div>
    <div class="bar-container">
      <div class="bar actual" id="actualBar">0%</div>
    </div>

    <button class="update-btn" onclick="updateProgress()">Manually Update Progress</button>

    <script>
      function updateProgress() {
        actualBar.style.width = 20 + "%";
        //google.script.run.callAlert();
        google.script.run.withSuccessHandler(function(data) {
          //google.script.run.callAlert();
          const actualBar = document.getElementById("actualBar");
          const percent = Math.round(data.percent * 10) / 10;

          //percent = 30;
    
          actualBar.style.width = percent + "%";
          actualBar.textContent = percent + "%";
        }).getProgressData();
      }

      setInterval(updateProgress, 30000);
      updateProgress();
    </script>

  </body>
</html>
